# 渲染管线    
```
1. 渲染管线也叫渲染流水线,一般由GPU(显卡的处理器)处理图像信号的并行处理单元组成; 这些并行的处理单元之间是相互独立的,一般越高端的硬件, 独立处理单元的数量就越多.

2. 实质上指的是一系列的绘制过程;向程序中输入待渲染的物体的相关描述信息数据,经过处理后,输出一帧图像
```

# 处理过程概述    
```
1. 通过api进行基本处理; 具体为设定物体的坐标,顶点颜色.顶点纹理坐标等属性, 并指定绘制方式,如点绘制,线段绘制等

2. 顶点缓冲对象; 存在整个场景中顶点基本不变的情况,可以在初始化阶段将顶点数据经过处理后送入顶点缓冲对象,这样绘制每帧就省去输入输出顶点数据的过程,直接从顶点缓冲对象中获取

3. 顶点着色器; 这是一个可编程的处理单元, 功能表现为顶点的变换,光照材质的应用与计算等与顶点相关的操作,每个顶点执行一次. 工作过程先把顶点的原始几何信息和其他属性传送到顶点着色器中,顶点着色器处理后产生相应坐标,颜色等,然后传递给图元装配阶段

4. 图元装配; 在这个阶段主要有两个任务，一个是图元组装，另一个是图元处理。所谓图元组装是指顶点数据根据设置的绘制方式被结合成完整的图元。例如，在点绘制方式下每个图元仅需要一个单独的顶点，在此方式下每个顶点为一个图元；在线段绘制方式每个图元则需要两个顶点，在此方式下每两个顶点构成一个图元；在三角形绘制方式下需要3个顶点构成一个图元。  
图元处理最重要的工作是剪裁，其任务是消除位于半空间（half-space）之外的部分几何图元，这个半空间是由一个剪裁平面定义的。例如，点剪裁就是简单地接受或者拒绝顶点，线段或多边形剪裁可能需要增加额外的顶点，这具体取决于直线或多边形与剪裁平面之间的位置关系.
要进行剪裁是因为随着观察位置、角度的不同，不能总看到（这里可以简单地理解为显示到设备屏幕上）特定物体上某个图元的全部。例如，当观察一个正四面体但它离某个三角形面很近时，可能只能看到此面的一部分，这时在屏幕上显示的就不再是三角形了，而是经过裁剪后形成的多边形
剪裁时，若图元完全位于视景体以及自定义剪裁平面的内部，则将图元传递到后续步骤进行处理；如果其完全位于视景体或者自定义剪裁平面的外部，则丢弃该图元；如果其有一部分位于内部，另一部分位于外部，则需要剪裁该图元.

5．光栅化; 将几何数据经过一系列变换后最终转换为像素,从而呈现在显示设备上的过程,

6．片元着色器; 片元着色器是处理片元值及相关数据的可编程单元，可以执行纹理采样、颜色汇总、计算雾颜色等操作，每个片元执行一次。片元着色器的主要功能为通过重复执行（每个片元一次），将3D物体中的图元光栅化后每个片元产生的颜色等属性计算出来并送入后继阶段，如剪裁测试、深度测试及模板测试等。
WebGL 2.0中的片元着色器与顶点着色器类似，需要开发人员用着色器语言编程。这在提高灵活性的同时也增加了开发的难度。

7．剪裁测试
如果程序中启用了剪裁测试，则程序会检查每个片元在帧缓冲中的对应位置。若对应位置在剪裁窗口中则将此片元送入下一阶段，否则丢弃此片元。

8.深度测试和模板测试
深度测试是指将输入片元的深度值与帧缓冲中存储的对应片元位置的深度值进行比较，若输入片元的深度值小，则将输入片元送入下一阶段，准备覆盖帧缓冲中的原片元或与帧缓冲中的原片元进行混合，否则丢弃输入片元。
模板测试的主要功能为将绘制区域限定在一定范围内。它一般用在湖面倒影、镜像等场合，后面的章节会详细介绍

9．颜色缓冲混合
若程序中开启了Alpha混合，则根据混合因子会将上一阶段送来的片元与帧缓冲中对应位置的片元进行Alpha混合；否则送入的片元将覆盖帧缓冲中对应位置的片元。

10．抖动
抖动是一种简单的操作，允许使用少量的颜色模拟出更宽的颜色显示范围，从而使颜色视觉效果更加丰富。例如，可以使用白色以及黑色模拟出一种过渡的灰色。

但使用抖动也是有缺点的，那就是会损失一部分分辨率，因此对于主流原生颜色已经很丰富的显示设备来说，一般是不需要启用抖动的。

一些系统虽然在API方面支持开启抖动，但这仅仅是为了API的兼容，可能根本不会执行事实上的抖动操作。

11．帧缓冲
WebGL 2.0中的物体绘制并不是直接在屏幕上进行的，而是预先在帧缓冲中进行绘制，每绘制完一帧将绘制结果交换到屏幕上。因此，在每次绘制新帧时都需要清除缓冲中的相关数据，否则有可能产生不正确的绘制结果。

同时需要了解的是为了应对不同方面的需要，帧缓冲是由一套组件组成的，主要包括颜色缓冲、深度缓冲以及模板缓冲，各组件的具体用途如下所示。

颜色缓冲用于存储每个片元的颜色值，每个颜色值包括R、G、B、A（红、绿、蓝、透明度）4个色彩通道，应用程序运行时在屏幕上看到的就是颜色缓冲中的内容。
深度缓冲用来存储每个片元的深度值。所谓深度值是指以特定的内部格式表示的从片元处到观察点（摄像机）的距离。在启用深度测试的情况下，新片元若想进入帧缓冲则需要将自己的深度值与帧缓冲中对应位置片元的深度值进行比较，若结果为小则有可能进入缓冲，否则被丢弃。
模板缓冲用来存储每个片元的模板值，供模板测试使用。模板测试是几种测试中最为灵活和复杂的一种，后面将由专门的章节进行介绍。
```


# 背面裁剪
通过相机观察物体卷绕的方向进行处理